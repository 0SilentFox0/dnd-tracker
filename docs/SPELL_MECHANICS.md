# Механіка заклинань — правила для трекера

Цей документ фіксує рішення щодо реалізації заклинань у додатку (спрощення щодо повної настільної механіки).

---

## 1. Тривалість (Duration)

- **Усі тривалості рахуються в раундах.**  
  1 раунд = усі учасники бою виконали по одному ходу.

- **Раннє завершення за умовою:**  
  Ефект може обірватися до кінця duration, якщо в описі вказано умову (наприклад, *Blind* — розвіюється, коли ціль отримує урон). Таку умову перевіряють гравці/DM під час гри; додаток лише зберігає duration у раундах.

- **Розвіювання:**  
  Будь-яке заклинання (ефект на цілі) може бути зняте заклинанням **Очищення (Cleansing)** / **Розвіювання**. Логіку «зняти ворожі заклинання з цілі/зони» реалізувати в додатку (наприклад, кнопка «Розвіяти» по ефекту або по цілі).

---

## 2. Атака заклинанням (Ranged spell attack)

- **Не використовувати окремий механізм «ranged spell attack».**  
  Заклинання, які в описі мають «Ranged spell attack», у трекері обробляються як звичайні заклинання: збереження (saving throw) або прямий ефект/урон без кидка атаки. Окремих кидків атаки заклинанням у додатку немає.

---

## 3. Заклинання контролю

- **Позначення:**  
  Заклинання контролю (наприклад, *Puppet Master*, *Frenzy*) лише **позначають на цілі дебаф** (іконка/статус). Додаток не керує тим, як ціль діє (на кого атакує, чи виконує команди тощо).

- **Поведінка під час гри:**  
  Гравці та DM самі вирішують, як діяти під контролем; трекер лише показує наявність ефекту.

---

## 4. Цільування

- **Без геометрії:**  
  Радіуси, лінії, конуси, форми AoE та іншу геометрію заклинань у додатку **не враховуємо**. Не потрібно обчислювати «хто в радіусі 20 ft» чи «хто в лінії».

- **Список цілей:**  
  Цільування — це **просто список доступних цілей**. Гравці самі обирають, на кого накласти заклинання/урон, з того списку, який показує додаток.

- **Важливо:** У виборі цілей завжди показуються **усі учасники бою** (герої, юніти, призиви тощо). Фільтрація «тільки вороги» / «тільки союзники» — опційна зручність UI, але механічно дозволено обирати будь-якого учасника; відповідальність за коректність вибору — на гравцях/DM.

---

## 5. Пастки (наприклад, Fire Trap)

- **Розміщення:**  
  Гравець сам визначає, де розміщені пастки (поза додатком або позначкою «пастка» без прив’язки до клітинок).

- **Спрацьовування:**  
  Якщо ворог наступає на клітинку з пасткою, **гравець повідомляє DM**; **DM сам застосовує урон** (наприклад, вручну змінює HP у трекері або оголошує результат за столом).

- **Висновок:** Пастки **не потрібно менеджерити в додатку** (автоматичне віднімання шкоди при «вході в клітинку» не реалізуємо).

---

## Підсумок для реалізації

| Питання | Рішення в трекері |
|--------|--------------------|
| Duration | Завжди в раундах; умовне раннє завершення + розвіювання Очищенням |
| Ranged spell attack | Не реалізуємо; обробляємо як звичайне заклинання (save/ефект) |
| Контроль | Тільки дебаф на цілі; поведінку вирішують гравці |
| Цільування | Список усіх учасників бою, без радіусів/геометрії |
| Пастки (Fire Trap тощо) | Не менеджеримо в додатку; гравець/DM вручну |

Ці правила використовувати при імпорті заклинань з CSV та при доработці бойової обробки заклинань.
